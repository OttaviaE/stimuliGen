---
title: "Distrattori"
author: "Andrea & Ottavia"
date: "`r Sys.Date()`"
output: 
  beamer_presentation: 
    theme: metropolis
    colortheme: orchid
    fonttheme: serif
    highlight: kate
classoption: aspectratio=1610 
header-includes:
    - \setbeamertemplate{navigation symbols}{}
    - \useoutertheme{miniframes}
    - \usepackage{graphicx} 
    - \usepackage{setspace}
    - \usepackage{tabularx}
    - \usepackage[english]{babel}
    - \usepackage{tikzsymbols}
    - \usepackage{subcaption}
    - \usepackage{tikz}
    - \usepackage{spot}
    - \usepackage{tabularx}
    - \usepackage[absolute,overlay]{textpos}
    - \usepackage{booktabs}
    - \newcommand\Factor{1.2}
    - \setbeamerfont{subtitle}{size=\large, series=\bfseries}
    - \definecolor{template}{RGB}{181, 18, 27}
    - \definecolor{background}{RGB}{250, 250, 250}
    - \setbeamercolor{frametitle}{bg=background}
    - \setbeamertemplate{frametitle}[default][center]
    - \AtBeginSection{\frame{\sectionpage}}
    - \setbeamercolor{section name}{fg=white}
    - \setbeamercolor{title}{fg=template, bg=template}
    - \setbeamercolor{section title}{fg=template}
    - \setbeamercolor{frame subtitle}{fg=template}
    - \setbeamercolor{title}{fg=template}
    - \setbeamersize{text margin left=5mm,text margin right=5mm} 
    - \AtBeginSection[]
          {
            \begin{frame}
             \frametitle{Table of Contents}
             \tableofcontents[currentsection]
            \end{frame}
            }
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, 
                      fig.align = "center")
library(DescTools)
source("Class and Methods.R")
source("Class and Methods extension.R")
source("Shapes_list.R")
source("Rules_27102022.R")
library(ggplot2)

## Forme modificate ad Hoc per questi esempi

lilth<-lily()
s.lilth<-s.lily()
for(i in 1:length(lilth$shape)) {
  lilth$size.x[[i]] <-lilth$size.x[[i]]/2
  lilth$size.y[[i]] <-lilth$size.y[[i]]/2
  lilth$pos.y[[i]] <-lilth$pos.y[[i]]/2
  lilth$pos.x[[i]] <-lilth$pos.x[[i]]/2
  
}

s.lilth$size.x[[1]] <-s.lilth$size.x[[1]]/2
s.lilth$size.y[[1]] <-s.lilth$size.y[[1]]/2
s.lilth$pos.y[[1]] <-s.lilth$pos.y[[1]]/2
s.lilth$pos.x[[1]] <-s.lilth$pos.x[[1]]/2

for(i in 1:length(lilth$shape)) {
  lilth$size.x[[i]] <-lilth$size.x[[i]]
  lilth$size.y[[i]] <-lilth$size.y[[i]]
  lilth$pos.y[[i]] <-lilth$pos.y[[i]]
  lilth$pos.x[[i]] <-lilth$pos.x[[i]]
  
}

s.lilth$size.x[[1]] <-s.lilth$size.x[[1]]
s.lilth$size.y[[1]] <-s.lilth$size.y[[1]]
s.lilth$pos.y[[1]] <-s.lilth$pos.y[[1]]
s.lilth$pos.x[[1]] <-s.lilth$pos.x[[1]]


xcros<- cross()
xcros$lwd<-xcros$lwd[[1]]+4
xcros$size.x<-xcros$size.x-4
xcros$size.y<-xcros$size.y-4

data = read.csv( "D:/PRIN2020/Raven/Raven-Distrattori/distrattori.csv", 
                header = T, sep = ",")

colnames(data)[ncol(data)] = "note"

for (i in 3:ncol(data)) {
  for (j in 1:nrow(data)) {
    if (data[j,i] == "x") {
      data[j, i] = 1
    }  else {
      data[j, i] = 0
    }
  }
}

data$set = gsub("[0-9]", "", data$Item)

small = data[, c("set", "Item",
                 "Distrattore", "R", "D", "WP", "IC", "R.IC")]
small$var = paste0(small$Item, small$Distrattore)
small = small[, c("set", "Item", "var", "Distrattore", 
                  "R", "D", "WP", "IC", "R.IC")]
long = reshape(small, 
        idvar = "var", 
        direction = "long", 
        varying = list(5:ncol(small)), 
        v.names = "used", 
        times = (colnames(small)[5:ncol(small)]), 
        timevar = "macro")  
sum_dist = data.frame(table(long$macro, long$used, long$set))
colnames(sum_dist) = c("macro", "used", "set", "Freq")
count_dist = aggregate(Freq ~ macro, data = sum_dist[sum_dist$used %in% 1, ], sum) 
colnames(count_dist)[2] = "label"
sum_dist = merge(sum_dist, count_dist, 
                 by = "macro")
```


# Tassonomia dei distrattori 

## 

\vspace*{-1cm}
\begin{figure}
\includegraphics[width=\linewidth]{tassonomia.pdf}
\end{figure}


## Piccola nota

- Set A-B: matrici $2 \times 2$ $\rightarrow$ 5 distrattori, una corretta

- Set C-E: matrici $3 \times 3$ $\rightarrow$  7 distrattori, una corretta

## I distrattori delle SPM

```{r, out.width = "50%"}
ggplot(sum_dist[sum_dist$used %in% 1, ], 
       aes(x = macro, y = label, fill = macro)) + 
  geom_bar(stat = "identity", position = position_dodge()) + theme_bw() + 
  theme(legend.position = "top", 
        legend.title = element_blank()) + 
  geom_text(aes(label=label), vjust=1.6, color="white",
            position = position_dodge(0.9), size=3.5)+
  scale_fill_brewer(palette="Paired")

```




::: columns

:::: column
left
::::

:::: column
right

```{r your-chunk-name, echo=FALSE, fig.cap="your-caption-name"}
plot(cars)

#The figure will appear on the right side of the slide...
```
::::

:::
