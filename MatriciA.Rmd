---
title: "Matrici"
author: "Andrea & Ottavia"
date: "`r Sys.Date()`"
output: 
    pdf_document: 
    toc: yes
---

```{r setup, include=FALSE}
#| echo: false
#| eval: true
set.seed(999)
knitr::opts_chunk$set(echo=FALSE, 
                      eval=TRUE, 
                      warning = F, 
                      message = F, 
                      fig.align = "center")

rm(list = ls())
select.dist = function(dist.list, selection) {
  resp = list()
for (i in 1:length(selection)) {
  resp[[i]] = dist.list[[selection[i]]]
  names(resp)[[i]] = selection[i]
}
    return(resp)
}


source("Shapes_list-10-11-Ottavia.R")
source("Class and Methods v02.R")
source("Rules_27102022.R")
source("DrawRegPolygon.R")
source("CodiceDistrattoriVero.R")

temp.dice = function(object){
  object<-movement(object,1,"pos",-10,11)
object<-size(object,4)
object2<-object
for(row in 1:3) {
  obj<-movement(object,row,"y")
  if(row>1)
  {
    object2<-cof(object2,obj)
  }
  
  for( col in 2:3 )
  {
    obj<-movement(obj,2,"x")
    object2<-cof(object2,obj)
    
  }
}
return(object2)
}


draws<- function(obj, main = NULL, canvas = TRUE, bg = "white",mar=c(1,1,1,1),xlim=16,by=1.5) {
  library(DescTools)
  if (canvas == TRUE)
  {
    Canvas(xlim=xlim,mar=mar, main = main, bg = bg)
  }
  for(j in 1:length(obj$shape))
  {
    if(obj$visible[[j]]==1)
    {
      if(obj$num[[j]][1]==1){
        if(grepl("line",obj$shade[[j]][1]))
        {
          elements<-decof(obj)
          plotting_lines<-which(obj$visible==1 & grepl("line",unlist(obj$shade)))
          for(ll in 1:length(plotting_lines)){
            line(elements[[plotting_lines[[ll]]]],obj$shade[[j]][1],lwd=3,by=by) #Pejo tacon che sbrego
            
          }
          obj$shade[[j]][1] <- NA
        }
        DrawRegPolygon(x = obj$pos.x[[j]], y = obj$pos.y[[j]], rot = obj$rotation[[j]],
                       radius.x = obj$size.x[[j]], radius.y = obj$size.y[[j]], nv = obj$nv[[j]],
                       lty=obj$lty[[j]],lwd=obj$lwd[[j]],col = obj$shade[[j]])
        
        
      }else{
        
        DrawCircle(x = obj$pos.x[[j]], y = obj$pos.y[[j]],
                   r.out = obj$size.x[[j]],r.in= obj$size.y[[j]], theta.1=obj$theta.1[[j]],
                   theta.2=obj$theta.2[[j]], nv = obj$nv[[j]],
                   lty=obj$lty[[j]],lwd=obj$lwd[[j]],col = obj$shade[[j]])
        
      }
    }
  }
}

lilth<-lily()
s.lilth<-s.lily()
for(i in 1:length(lilth$shape)) {
  lilth$size.x[[i]] <-lilth$size.x[[i]]/2
  lilth$size.y[[i]] <-lilth$size.y[[i]]/2
  lilth$pos.y[[i]] <-lilth$pos.y[[i]]/2
  lilth$pos.x[[i]] <-lilth$pos.x[[i]]/2
  
}

s.lilth$size.x[[1]] <-s.lilth$size.x[[1]]/2
s.lilth$size.y[[1]] <-s.lilth$size.y[[1]]/2
s.lilth$pos.y[[1]] <-s.lilth$pos.y[[1]]/2
s.lilth$pos.x[[1]] <-s.lilth$pos.x[[1]]/2

papillon = bow.tie()
u.papillon = u.bow.tie()


for(i in 1:length(papillon$shape)) {
  papillon$size.x[[i]] <-papillon$size.x[[i]]/2
  papillon$size.y[[i]] <-papillon$size.y[[i]]/2
  papillon$pos.y[[i]] <-papillon$pos.y[[i]]/2
  papillon$pos.x[[i]] <-papillon$pos.x[[i]]/2
  
}

u.papillon$size.x[[1]] <-u.papillon$size.x[[1]]/2
u.papillon$size.y[[1]] <-u.papillon$size.y[[1]]/2
u.papillon$pos.y[[1]] <-u.papillon$pos.y[[1]]/2
u.papillon$pos.x[[1]] <-u.papillon$pos.x[[1]]/2


thepie = pie.4()
u.thepie = u.pie.4()


for(i in 1:length(thepie$shape)) {
  thepie$size.x[[i]] <-thepie$size.x[[i]]/2
  thepie$size.y[[i]] <-thepie$size.y[[i]]/2
  thepie$pos.y[[i]] <-thepie$pos.y[[i]]/2
  thepie$pos.x[[i]] <-thepie$pos.x[[i]]/2
  
}

u.thepie$size.x[[1]] <-u.thepie$size.x[[1]]/2
u.thepie$size.y[[1]] <-u.thepie$size.y[[1]]/2
u.thepie$pos.y[[1]] <-u.thepie$pos.y[[1]]/2
u.thepie$pos.x[[1]] <-u.thepie$pos.x[[1]]/2

biscuit = star()
u.biscuit = u.star()


for(i in 1:length(biscuit$shape)) {
  biscuit$size.x[[i]] <-biscuit$size.x[[i]]/2
  biscuit$size.y[[i]] <-biscuit$size.y[[i]]/2
  biscuit$pos.y[[i]] <-biscuit$pos.y[[i]]/2
  biscuit$pos.x[[i]] <-biscuit$pos.x[[i]]/2
  
}

u.biscuit$size.x[[1]] <-u.biscuit$size.x[[1]]/2
u.biscuit$size.y[[1]] <-u.biscuit$size.y[[1]]/2
u.biscuit$pos.y[[1]] <-u.biscuit$pos.y[[1]]/2
u.biscuit$pos.x[[1]] <-u.biscuit$pos.x[[1]]/2


square4bis <- function() {
  value <-cof(hline(pos.y=-11),vline(pos.x=11),
              hline(pos.y=11),vline(pos.x=-11))
  value$tag <- list("compose4")
  attr(value, "class") <- "field"
  value
}


smallbow.tie.inv <- function(pos.x = 0,pos.y=0,shd=NA) {
  value <-cof(triangle(pos.x = pos.x+5, pos.y = pos.y, rot=pi/3, 
                       s.x = 5, s.y=5,shd = shd), 
              triangle(pos.x = pos.x-5, pos.y = pos.y, rot=-pi, 
                       s.x = 5, s.y=5,shd = shd))
  value$tag <- list("compose2","fill", "rotate")
  attr(value, "class") <- "field"
  value
}


u.smallbow.tie.inv <- function(pos.x = 0,pos.y=0,shd=NA) {
  value <-cof(triangle(pos.x = pos.x+5, pos.y = pos.y, rot=pi/3, 
                       s.x = 5, s.y=5,shd = shd), 
              triangle(pos.x = pos.x-5, pos.y = pos.y, rot=-pi, 
                       s.x = 5, s.y=5,shd = shd), 
              single = T, name = "u.smallbowtie.inv")
  value$tag <- list("compose2","fill", "rotate")
  attr(value, "class") <- "field"
  value
}

bow.tie.inv <- function(pos.x = 0) {
  value <-cof(triangle(pos.x = pos.x+10, pos.y = pos.x, rot=pi/3, 
                       s.x = 10, s.y=10), 
              triangle(pos.x = pos.x-10, pos.y = pos.x, rot=-pi, 
                       s.x = 10, s.y=10))
  value$tag <- list("compose2","fill", "rotate")
  attr(value, "class") <- "field"
  value
}



blu = "deepskyblue3"

giallo = "gold"

rosso = "firebrick"


```

\newpage

# Young 

\newpage

## young001

```{r}

draw(rectangle(s.x=-50,s.y=50,shd=blu,pos.x=+10,pos.y=-7))
draw(diagline(pos.x=-50, s.x = 50, lwd = 3, shd = giallo), canvas = F)
for(i in seq(-50, 50, by = 3.5)) {
  draw(diagline(pos.x = i, s.x=40, lwd = 3), 
       canvas = F)
}


draw(diagline.inv(pos.x=-50, s.x = 50, lwd = 3), canvas = F)
for(i in seq(-50, 50, by = 3.5)) {
  draw(diagline.inv(pos.x = i, s.x=40, lwd = 3), 
       canvas = F)
}


draw(rectangle(s.x=7,s.y=5,shd="white",pos.x=+10,pos.y=-7),
     canvas = FALSE)
```

```{r out.width="80%"}

par(mfrow =c(2, 3), mar = c(0.5, 6, 0.5, 2) + .1, 
          mai=c(.1,.1,.1,.1),oma=c(4,4,0.2,0.2) )

container = rectangle(s.x=7,s.y=5,shd=blu)

draw(container,xlim = 8, main = "correct")
draws(rectangle(s.x=7,s.y=5,shd="line.12.inv"),by=3.5,
     canvas = FALSE)

draws(rectangle(s.x=7,s.y=5,shd="line.12"),by=3.5,
     canvas = FALSE)

draw(container,xlim = 8, main = "ic.scale")
draws(rectangle(s.x=7,s.y=5,shd="line.12"),
     canvas = FALSE)
draws(rectangle(s.x=7,s.y=5,shd="line.12.inv"),
     canvas = FALSE)

draw(container,xlim = 8, main = "difference")

draw(container,xlim = 8, main = "difference")
for (i in seq(-6, 7, by = 3)) {
  for (j in seq(-3, 3, by = 3)) {
    draw(dot(pos.x = i, pos.y = j, size.x = 0.5, size.y = 0.5), canvas = F)
  }
}


draw(container,xlim = 8, main = "ic.flip")
for(i in seq(-7, 7, by = 1)) {
 draw(vline(pos.x = i, s.x=5, lwd = 3), canvas = F)
}

for(i in seq(-5, 5, by = 1)) {
 draw(hline(pos.y = i, s.x=7, lwd = 3), canvas = F)
}

```

## young002 

```{r}
draw(rectangle(s.x=-50,s.y=50,shd=giallo,pos.x=+10,pos.y=-7))
draw(dot(pos.x = -30, pos.y = 15, size.x = 1, size.y = 1, shd = blu), canvas = F)

for (i in seq(-30, 30, by = 4)) {
  for (j in seq(15, -19, by = -4)) {
    draw(dot(pos.x = i, pos.y = j, size.x = 1, size.y = 1, shd = blu), canvas = F)
  }
}

draw(rectangle(s.x=7,s.y=5,shd="white",pos.x=+15,pos.y=-10),
     canvas = FALSE)

```


```{r out.width="80%"}

par(mfrow =c(2, 3), mar = c(0.5, 6, 0.5, 2) + .1, 
          mai=c(.1,.1,.1,.1),oma=c(4,4,0.2,0.2) )

container = rectangle(s.x=7,s.y=5,shd=giallo)

draw(container,xlim = 8, main = "correct")
clip(7,-7,5,-5)
for (i in seq(-21, 25, by = 4)) {
  for (j in seq(12.5, -15, by = -4)) {
     draw(dot(pos.x = i, pos.y = j, size.x = 1, size.y = 1, shd = blu), canvas = F)
  }
}

draw(container,xlim = 8, main = "ic.neg")
clip(7,-7,5,-5)
draw(rectangle(s.x=7,s.y=5,shd=blu,pos.x=0,pos.y=0),
     canvas = FALSE)
for (i in seq(-25, 25, by = 4)) {
  for (j in seq(15, -15, by = -4)) {
        draw(dot(pos.x = i, pos.y = j, size.x = 1, size.y = 1, shd = giallo), canvas = F)
  }
}


draw(container,xlim = 8, main = "difference")


draw(container,xlim = 8, main = "difference1")
clip(7,-7,5,-5)
for (i in seq(-21, 25, by = 4)) {
  for (j in seq(12.5, -15, by = -4)) {
     draw(square(pos.x = i, pos.y = j, s.x = 1, s.y = 1, shd = blu), canvas = F)
  }
}


draw(container,xlim = 8, main = "boh")
draws(rectangle(s.x=7,s.y=5,shd="line.12.inv"),by=3.5,
     canvas = FALSE)
draws(rectangle(s.x=7,s.y=5,shd="line.12"),by=3.5,
     canvas = FALSE)

```


## Young003

```{r}

draw(rectangle(s.x=-50,s.y=50,shd=blu,pos.x=+10,pos.y=-7))
draw(vline(pos.x = -20, s.x = 50, lwd = 3), canvas = F)
draw(vline(pos.x = 20, s.x = 50, lwd = 3, lty = 3), canvas = F)
draw(vline(pos.x = 17, s.x = 50, lwd = 3), canvas = F)
draw(hline(pos.y = 9, s.x = 50, lwd = 3, lty = 1), canvas = F)
draw(hline(pos.y = -9, s.x = 50, lwd = 3, lty = 1), canvas = F)
draw(hline(pos.y = -12, s.x = 50, lwd = 3, lty = 3), canvas = F)


draw(rectangle(s.x=7,s.y=5,shd="white",pos.x=+15,pos.y=-10),
     canvas = FALSE)
```


```{r out.width="80%"}

par(mfrow =c(2, 3), mar = c(0.5, 6, 0.5, 2) + .1, 
          mai=c(.1,.1,.1,.1),oma=c(4,4,0.2,0.2) )

container = rectangle(s.x=7,s.y=5,shd=blu)

draw(container,xlim = 8, main = "correct")

draw(rectangle(s.x=7,s.y=5,shd=NA,pos.x=0,pos.y=0),
     canvas = FALSE)

draw(vline(pos.x = 5, pos.y = -0, 
           s.x  = 5, lwd = 3, lty = 3), canvas = F)
draw(vline(pos.x = 2, pos.y = 0, 
           s.x = 5, lwd = 3), canvas = F)

draw(hline(pos.y = 0, 
           pos.x = 0,  s.x = 7, lwd = 3, lty = 1), canvas = F)
draw(hline(pos.y = -3, pos.x = 0, s.x = 7, lwd = 3, lty = 3), canvas = F)

##primo distrattore
draw(container,xlim = 8, main = "ic")

draw(rectangle(s.x=7,s.y=5,shd=NA,pos.x=0,pos.y=0),
     canvas = FALSE)

draw(vline(pos.x = 5, pos.y = -0, 
           s.x  = 5, lwd = 3, lty = 1), canvas = F)
draw(vline(pos.x = 2, pos.y = 0, 
           s.x = 5, lwd = 3), canvas = F)

draw(hline(pos.y = 0, 
           pos.x = 0,  s.x = 7, lwd = 3, lty = 1), canvas = F)
draw(hline(pos.y = -3, pos.x = 0, s.x = 7, lwd = 3, lty = 1), canvas = F)

##Secondo distrattore

draw(container,xlim = 8, main = "ic")

draw(rectangle(s.x=7,s.y=5,shd=NA,pos.x=0,pos.y=0),
     canvas = FALSE)

draw(vline(pos.x = -5, pos.y = -0, 
           s.x  = 5, lwd = 3, lty = 3), canvas = F)
draw(vline(pos.x = -2, pos.y = 0, 
           s.x = 5, lwd = 3), canvas = F)

draw(hline(pos.y = 0, 
           pos.x = 0,  s.x = 7, lwd = 3, lty = 1), canvas = F)
draw(hline(pos.y = 3, pos.x = 0, s.x = 7, lwd = 3, lty = 3), canvas = F)

##terzo distrattore
draw(container,xlim = 8, main = "wp")
draws(rectangle(s.x=7,s.y=5,shd="line.12.inv"),by=3.5,
     canvas = FALSE)

##quarto
draw(container,xlim = 8, main = "difference")

```


## young004

```{r}

draw(rectangle(s.x=-50,s.y=50,shd=giallo,pos.x=+10,pos.y=-7))
draw(vline(pos.x=-50, s.x = 30, lwd = 1), canvas = F)
for(i in seq(-30, 30, by = 2)) {
  
    draw(vline(pos.x = i, s.x=40, lwd = 1+ abs(i)/2), 
         canvas = F,  bg = "white")
}

draw(rectangle(s.x=7,s.y=5,shd="white",pos.x=+15,pos.y=-10),
     canvas = FALSE)
```



```{r out.width="80%"}
par(mfrow =c(2, 3), mar = c(0.5, 6, 0.5, 2) + .1, 
          mai=c(.1,.1,.1,.1),oma=c(4,4,0.2,0.2) )

container = rectangle(s.x=7,s.y=5,shd=giallo)

draw(container,xlim = 8, main = "correct")
clip(7,-7,5,-5)
#for(i in seq(14, 30, by = 1)) {
for(i in seq(6, 22, by = 2)) {
  
    draw(vline(pos.x = i-15, s.x=40, lwd = 1+ abs(i)/2), 
         canvas = F,  bg = "white")
}


draw(container,xlim = 8, "wp")
clip(7,-7,5,-5)
for(i in seq(14, 30, by = 1)) {
  
    draw(vline(pos.x = i-22, s.x=40, lwd = 5), 
         canvas = F,  bg = "white")
}

draw(container,xlim = 8, main = "difference")

draw(container,xlim = 8, main = "boh")
draws(rectangle(s.x=7,s.y=5,shd="line.12.inv"),by=3.5,
     canvas = FALSE)

draw(container,xlim = 8, "wp")
draws(rectangle(s.x=7,s.y=5,shd="line.12.inv"),by=3.5,
     canvas = FALSE)
draws(rectangle(s.x=7,s.y=5,shd="line.12"),by=3.5,
     canvas = FALSE)
```

## Young005

```{r}
draw(rectangle(s.x=-50,s.y=50,pos.x=+10,pos.y=-7),bg=blu)

for(j in seq(0, 3, by = .2)) {
  draw(diagline(pos.x = 30,pos.y = 10, s.x=100, rot=(pi/8)*j, lwd = 3,lty=2), 
       canvas = F)
}

for(j in c(seq(-20, -5, by = 3),seq(5, 15, by = 1.5))) {
  draw(vline(pos.x = j, s.x=100, lwd = 3,lty = 1), 
       canvas = F)
}

for(j in seq(-15, -5, by = 3)) {
  draw(hline(pos.y = j, s.x=100, lwd = 3,lty = 1), 
       canvas = F)
}
draw(rectangle(s.x=7,s.y=5,shd="white",pos.x=+15,pos.y=-10),
     canvas = FALSE)
```

```{r out.width="80%"}
par(mfrow =c(2, 3), mar = c(0.5, 6, 0.5, 2) + .1, 
    mai=c(.1,.1,.1,.1),oma=c(4,4,0.2,0.2) )

container = rectangle(s.x=7,s.y=5,shd=blu)

draw(container,xlim = 8)
clip(7,-7,5,-5)
for(j in seq(0, 3, by = .2)) {
  draw(diagline(pos.x =30- 15,pos.y = 10-(-10), s.x=100, rot=(pi/8)*j, lwd = 3,lty=2), 
       canvas = F)
}

for(j in c(seq(-20, -5, by = 3),seq(5, 15, by = 1.5))) {
  draw(vline(pos.x = j-15, s.x=100, lwd = 3,lty = 1), 
       canvas = F)
}

for(j in seq(-15, -5, by = 3)) {
  draw(hline(pos.y = j+10, s.x=100, lwd = 3,lty = 1), 
       canvas = F)
}


draw(container,xlim = 8)
clip(7,-7,5,-5)
for(j in seq(0, 3, by = .2)) {
  draw(diagline(pos.x =30- 15,pos.y = 10-(-10), s.x=100, rot=(pi/8)*j, lwd = 3,lty=2), 
       canvas = F)
}

for(j in c(seq(-20, -5, by = 3),seq(5, 15, by = 1.5))) {
  draw(vline(pos.x = j-15, s.x=100, lwd = 3,lty = 1), 
       canvas = F)
}

draw(container,xlim = 8)

draw(container,xlim = 8)
draws(rectangle(s.x=7,s.y=5,shd="line.12.inv"),by=3.5,
      canvas = FALSE)

draw(container,xlim = 8)
draws(rectangle(s.x=7,s.y=5,shd="line.12.inv"),by=3.5,
      canvas = FALSE)
draws(rectangle(s.x=7,s.y=5,shd="line.12"),by=3.5,
      canvas = FALSE)

```


## Young006

```{r young006}
young006 = apply(Raven(
    st1 = cof( 
              rectangle(s.x = 25, s.y = 15, pos.y = -1, shd = blu), 
              triangle(pos.y = 0, s.x = 12, s.y = 12, shd = giallo)), 
    vrule = "reflection", 
    hrule = "identity"
))
draw(young006, n.cell = 4, hide = F)
```


```{r out.width="80%"}
dist_young006 = responses(young006,mat.type = 4, which.element = "triangle")

selection = c("correct", "r.top", "d.union", "wp.matrix", "ic.flip")




resp_young006 = select.dist(dist_young006, selection)

resp_young006[["d.union"]] =cof(resp_young006[["d.union"]], 
                                square())
resp_young006[["wp.matrix"]] =cof(resp_young006[["wp.matrix"]], 
                                e.hexagon())

p = split.mat(young006)

resp_young006[["ic.flip"]] = cof(p$rectangle, 
                                rotation(p$triangle, 2))


draw.dist(resp_young006, n.resp = 11, main = T)
```


## Young007

```{r}
young007a = apply(Raven(
  st1 = pacman(size.x = 7, shd = rosso), 
  hrule = "reflection", 
  vrule = "reflection"
))

young007b = apply(Raven(
  st1 = pentagon(shd = giallo), 
  hrule = "identity", 
  vrule = "identity"
))


young007 = com(young007b, young007a)
draw(young007, n.cell = 4)

```


```{r out.width="80%"}
dist_young007 = responses(young007,mat.type = 4)

resp_young007 = select.dist(dist_young007, selection)

resp_young007[["d.union"]] = cof(resp_young007[["d.union"]], 
                                 pie.4())
resp_young007[["wp.matrix"]] = cof(resp_young007[["wp.matrix"]], 
                                 dice())
 p = split.mat(young007, mat.type  = 4)

resp_young007[["ic.flip"]] = cof(rotation(p[[1]], 2), 
                                 p[[2]]) 
 
 draw.dist(resp_young007, n.resp = 5, main = T)
```


## Young008

```{r}

young008a = apply(Raven(
  st1 = dot(), 
  vrule = "fill"
))

young008b = apply(Raven(
  st1 = pacman(shd = rosso), 
  "reflection"
))

young008 = com(young008b, young008a)

draw(young008, n.cell = 4)
```

```{r out.width="80%"}
dist_young008 = responses(young008, mat.type = 4)
resp_young008 = select.dist(dist_young008, selection)

resp_young008[["wp.matrix"]] = cof(resp_young008[["wp.matrix"]], 
                                 rotation(pacman(shd = rosso), 3))
resp_young008[["d.union"]] = cof(resp_young008[["d.union"]], 
                                 pentagon())
p = split.mat(young008, mat.type = 4)

resp_young008[["ic.flip"]] = cof(rotation(p[[1]], 3), 
                                 p[[2]])

draw.dist(resp_young008, n.resp = 5)

```


## Young009

```{r}
young009a = apply(Raven(
  st1 = cof(s.lilth, 
            pacman(size.x = 5), ellipse()),
  vrule = "diff_shapes"
  
))

young009b = apply(Raven(
  st1 = cof(e.hexagon(shd = blu), 
            circle(shd = giallo,s.x = 15, s.y = 15), 
            triangle()), 
  vrule = "diff_shapes"
))

young009 = com(young009b, young009a)

draw(young009, n.cell = 4)

```

```{r out.width="80%"}

dist_young009 = responses(young009, mat.type = 4)

resp_young009 = select.dist(dist_young009, selection)

resp_young009[["d.union"]] = cof(resp_young009[["d.union"]], 
                                 cross.dice())
resp_young009[["wp.matrix"]] = cof(resp_young009[["wp.matrix"]], 
                                 pacman())

 p = split.mat(young009, mat.type  = 4)

resp_young009[["ic.flip"]] = cof( 
                                 p[[1]], rotation(p[[2]], 3)) 

draw.dist(resp_young009, n.resp = 5)

```

## young010 

```{r}

young010a = apply(Raven(
  st1 = cof(u.pie.2(size.x = 5, shd = blu),
           u.pie.4(size.x = 5, shd = rosso), ellipse()),
  vrule = "diff_shapes"

))

young010b = apply(Raven(
  st1 = cof(e.hexagon(shd = giallo, s.x = 13, s.y = 13),
            triangle(shd = giallo, s.x = 15, s.y = 15),
            circle()),
  hrule = "diff_shapes"
))

young010 = com(young010b, young010a)

draw(young010, n.cell = 4)
```

```{r out.width="80%"}

dist_young010 = responses(young010, mat.type = 4)
resp_young010 = select.dist(dist_young010, selection)

resp_young010[["d.union"]] = cof(resp_young010[["d.union"]], 
                                 cross(), 
                                 pentagon())

resp_young010[["wp.matrix"]] = cof(resp_young010[["wp.matrix"]], 
                                 triangle())
p = split.mat(young010,mat.type  = 4)


resp_young010[["ic.flip"]] = cof(rotation(p[[1]], 3), 
                                 p[[2]])

draw.dist(resp_young010, n.resp = 5)

```


## young011

```{r}


young011 = apply(Raven(
  st1 = cof(pentagon(shd = giallo, s.x = 13, s.y = 13),
            triangle(shd = giallo, s.x = 15, s.y = 15),
            circle()),
  vrule = "reflection", 
  hrule = c( "reflection", "diff_shapes")
))


draw(young011, n.cell = 4)
```

```{r out.width="80%"}
dist_young011 = responses(young011, mat.type = 4) 

resp_young011 = select.dist(dist_young011, selection)

resp_young011[["d.union"]] = cof(resp_young011[["d.union"]], 
                                 resp_young011[["wp.matrix"]], 
                                 lily())

resp_young011[["wp.matrix"]] = cof(
                                 resp_young011[["wp.matrix"]], 
                                 triangle())


draw.dist(resp_young011, n.resp = 5)
```


## Young012 


```{r}

young012a = apply(Raven(
  st1 = cof(pentagon(shd = giallo, s.x = 13, s.y = 13),
            triangle(shd = giallo, s.x = 15, s.y = 15),
            circle()),
  vrule = "diff_shapes",
  hrule = "reflection"
))

young012b = apply(Raven(
  st1 = dot(size.x = 2, size.y = 1, shd = rosso)
))

young012 = com(young012a, young012b)
draw(young012, n.cell = 4)
```

```{r out.width="80%"}
dist_young012 = responses(young012, mat.type = 4)

resp_young012 = select.dist(dist_young012, selection)

resp_young012[["d.union"]] = cof(resp_young012[["d.union"]], 
                                 size(square(shd = rosso), 3))

resp_young012[["wp.matrix"]] =  cof(resp_young012[["r.top"]], 
                                 resp_young012[["wp.matrix"]])

p = split.mat(young012, mat.type = 4)



resp_young012[["ic.flip"]] =cof(reflection(p[[1]], 2), 
                                p[[2]])

draw.dist(resp_young012, n.resp = 5)

```

## young013 


```{r}
young013 = apply(
  Raven(
    st1 = pentagon(rot=pi/2), 
    vrule = "reflection"
  )
)
draw(young013, n.cell = 4)



```


```{r out.width="80%"}
selection.neg = c("correct", "r.top", "d.union", "wp.matrix", "ic.neg")


dist_young013 = responses(young013,mat.type = 4)
resp_young013 = select.dist(dist_young013, selection.neg)

draw.dist(resp_young013, n.resp = 5, main = T)
```


## young014 

```{r}
young014 = apply(
  Raven(
    st1 = pacman(), 
    vrule = "reflection",
    hrule = "reflection"
  )
)
draw(young014, n.cell = 4)

```

```{r out.width="80%"}
dist_young014 = responses(young014,mat.type = 4)

resp_young014 = select.dist(dist_young014, selection.neg)
draw.dist(resp_young014, n.resp = 5, main = T)
```


## Young015

```{r}
young015 = apply(
  Raven(
    st1 = triangle(), 
    vrule = "fill",
    hrule = "reflection"
  )
)
draw(young015, n.cell = 4)


```

```{r out.width="80%"}

dist_young015 = responses(young015,mat.type = 4)

resp_young015 = select.dist(dist_young015, selection.neg)
resp_young015$ic.neg$shade = "black"

draw.dist(resp_young015, n.resp = 5, main = T)
```


## Young016

```{r}
young016 = apply(
  Raven(
    st1 = cof(square(),e.hexagon(),pacman()), 
    vrule = c("diff_shapes","fill")
  )
)
draw(young016, n.cell = 4)


```


```{r out.width="80%"}

dist_young016 = responses(young016,mat.type = 4)

resp_young016 = select.dist(dist_young016, selection.neg)

resp_young016[["wp.matrix"]] = cof(resp_young016[["wp.matrix"]] , 
                                   resp_young016[["r.top"]] )

#resp_young016$ic.neg$shade = "black"
draw.dist(resp_young016, n.resp = 5, main = T)

```


## young017

```{r}
young017a = apply(
  Raven(
    st1 = cof(luck(),circle(),pacman()), 
    vrule = c("diff_shapes")
  )
)

young017b = apply(
  Raven(
    st1 = cof(dot(),triangle(s.x=3,s.y = 3),pacman()), 
    hrule = c("diff_shapes")
  )
)

young017<- com(young017a,young017b)
draw(young017, n.cell = 4)


```


```{r out.width="80%"}
dist_young017 = responses(young017,mat.type = 4)
resp_young017 = select.dist(dist_young017, selection.neg)

# p = split.mat(young017, mat.type = 4)
# 
# 
# p$triangle$shade = "black"
# resp_young017$ic.neg = cof(p$circle, 
#                            p$triangle)


draw.dist(resp_young017, n.resp = 5, main = T)


```

## young018

```{r}
young018 = apply(
  Raven(
    st1 = cof(pentagon(),triangle() ,pacman()), 
    vrule = c("diff_shapes","reflection")
  )
)
draw(young018, n.cell = 4)



```


```{r out.width="80%"}
dist_young018 = responses(young018,mat.type = 4)

resp_young018 = select.dist(dist_young018, selection.neg)


draw.dist(resp_young018, n.resp = 5, main = T)
```


## Young019

```{r}
young019 = apply(
  Raven(
    st1 = cof(triangle(rot = pi) ,pacman(),square()), 
    vrule = c("diff_shapes"),
    hrule = c("reflection")
  )
)
draw(young019, n.cell = 4)



```


```{r out.width="80%"}
dist_young019 = responses(young019,mat.type = 4)
resp_young019 = select.dist(dist_young019, selection.neg)


draw.dist(resp_young019, n.resp = 5, main = T)

```

## young020

```{r}
young020 = obj_addition_rules(
  Raven(
    st1 = cof(cross(),square()) 
  ), rule="v.add"
)

young020frame =  apply(Raven(
  st1 = rectangle(s.x = 20, s.y = 15, shd = blu)
))

young020 = com(young020frame, young020)
draw(young020, n.cell = 4)


```

```{r out.width="80%"}
selection.neg = c("correct", "r.top", "d.union", "wp.matrix", "ic.inc")
dist_young020 = responses(young020, mat.type = 4)


selec_add = c("correct", "r.top", 
              "d.union", "ic.scale", "wp.matrix")

resp_young020 = select.dist(dist_young020, 
                            selec_add)

resp_young020[["wp.matrix"]] = cof(resp_young020[["wp.matrix"]], 
                                   rotation(square(), 2))

# p = split.mat(young020)
# 
# resp_young020[["ic.scale"]] = cof(p[[1]], 
#          size(p[[2]], 2), 
#          size(p[[3]], 2))
# 
# resp_young020 = select.dist(dist_young020, selection.neg)
# 
# resp_young020[["wp.matrix"]] = cof(resp_young020[["wp.matrix"]] , 
#                                    dot() )
# resp_young020[["ic.inc"]] = show(resp_young020[["ic.inc"]] ,index=1:2 )
# resp_young020[["ic.inc"]] = hide(resp_young020[["ic.inc"]], 3 )


draw.dist(resp_young020, n.resp = 5, main = T)
```

## young021

```{r}
young021a = obj_addition_rules(
  Raven(
    st1 = cof(s.lily(),size(u.biscuit, 3)) 
  ), rule="vh.sott"
)

young021b = apply(
  Raven(
    st1 =e.hexagon(shd="firebrick") )
)

young021<-com(young021b,young021a)
draw(young021, n.cell = 4, bg="white")

```


```{r out.width="80%"}
dist_young021 = responses(young021,mat.type = 4)

resp_young021 = select.dist(dist_young021, 
                            selec_add)


#draw.dist(resp_young021, n.resp = 5, main = T)


selection.neg = c("correct", "r.top", "d.union", "wp.matrix", "ic.flip")
resp_young021 = select.dist(dist_young021, selection.neg)
draw.dist(resp_young021, n.resp = 5, main = T)


```

## young022

```{r}
young022a = obj_addition_rules(
  Raven(
    st1 = cof(cross(),e.hexagon(s.x = 10,s.y=10))
  )
  , rule="vh.sott"
)

young022b = apply(
  Raven(
    st1 =square(shd = "gold") )
)

young022<-com(young022b,young022a)



draw(young022, n.cell = 4, bg="deepskyblue3")


```


```{r out.width="80%"}
dist_young022 = responses(young022,mat.type = 4)


resp_young022 = select.dist(dist_young022, 
                            selec_add)

resp_young022[["d.union"]] = cof(dist_young022$r.top, 
                                 lily())

#draw.dist(resp_young022, n.resp = 5, main = T)

selection.neg = c("correct", "r.top", "d.union", "wp.matrix", "ic.flip")
resp_young022 = select.dist(dist_young022, selection.neg)
draw.dist(resp_young022, n.resp = 5, main = T)

```

## young023 

```{r}

young023 = obj_addition_rules(
  Raven(
    st1 = cof(cross(),square(rot = pi)) 
  ), rule="v.sott"
)

draw(young023, n.cell = 4)

```


```{r out.width = "80%"}
selection.neg = c("correct", "r.top", "d.union", "wp.matrix", "ic.inc")
dist_young023 = responses(young023,mat.type = 4)


resp_young023 = select.dist(dist_young023, 
                            selec_add)


#draw.dist(resp_young023, n.resp = 5, main = T)

#resp_young023 = select.dist(dist_young023, selection.neg)

draw.dist(resp_young023, n.resp = 5, main = T)

```


## young024

```{r}
young024a = obj_addition_rules(
  Raven(
    st1 = cof(circle(s.x=8,s.y = 8),dot()) 
  ), rule="vh.add"
)

young024b = apply(
  Raven(
    st1 = pentagon() )
)

young024<-com(young024a,young024b)
draw(young024, n.cell = 4)

```


```{r out.width="80%"}

selection.neg = c("correct", "r.top", "d.union", "wp.matrix", "ic.flip")
dist_young024 = responses(young024,mat.type = 4)

resp_young024 = select.dist(dist_young024, 
                            selec_add)
resp_young024[["d.union"]] = cof(resp_young024$d.union, 
                                 size(biscuit, 1))

#draw.dist(resp_young024, n.resp = 5, main = T)


resp_young024 = select.dist(dist_young024, selection.neg)

draw.dist(resp_young024, n.resp = 11, main = T)

```


## young025

```{r}
young025a = obj_addition_rules(
  Raven(
    st1 = cof(cof(circle(s.x = 7,s.y = 7),dot(),name="oggetto",single=TRUE ),
              dice()) 
  ), rule="vh.add"
)

young025b = apply(
  Raven(
    st1 =luck() )
)

young025<-com(young025a,young025b)
draw(young025, n.cell = 4)
```


```{r out.width="80%"}
selection.neg = c("correct", "r.top", "d.union", "wp.matrix", "ic.flip")
dist_young025 = responses(young025,mat.type = 4)


resp_young025 = select.dist(dist_young025, 
                            selec_add)
resp_young025[["d.union"]] = cof(resp_young025$d.union, 
                                 bow.tie())

p = split.mat(young025)

resp_young025[["ic.scale"]] = cof(size(p[[1]], 2), p[[2]],
         size(p[[3]], 2))
  

# draw.dist(resp_young025, n.resp = 5, main = T)

resp_young025 = select.dist(dist_young025, selection.neg)
resp_young025[["ic.flip"]] = replace(resp_young025[["ic.flip"]] ,3 ,luck(rot = pi) )
draw.dist(resp_young025, n.resp = 5, main = T)

```


## young026 

```{r}
set.seed(999)
young026a = apply(
  Raven(
    st1 = cof(square(shd = giallo), u.bow.tie(shd = giallo), triangle(rot = pi/2, shd = giallo)), 
    vrule = c("diff_shapes"), 
    hrule = "identity"
  )
)

young026b = apply(Raven(
  st1 = cof(dot(shd = blu))
))

young026 = com(young026a, young026b)
draw(young026, n.cell = 9)


```

```{r out.width="80%"}


dist_young026 = responses(young026)
select.new = c("correct", "r.diag", 
               "wp.copy", "wp.matrix", 
               "ic.inc", "ic.scale", "ic.flip", "d.union")

resp_young026 = select.dist(dist_young026, 
                            select.new)

p = split.mat(young026)


selection.neg = c("correct", "r.diag", "d.union","wp.copy","wp.matrix", "ic.scale","ic.flip","ic.inc")

dist_young026 = responses(young026,mat.type = 9)
resp_young026 = select.dist(dist_young026, selection.neg)

# avendo cambiato il codice devo fare a mano ic flip 

resp_young026[["ic.flip"]] = replace(correct(young026), 
                                    3, 
                                    rotation(p$triangle, 2))

draw.dist(resp_young026, n.resp = 8, main = T)

```


## young027 

```{r}
young027a= apply(
  Raven(
    st1 = cof(pentagon(shd = rosso), triangle(shd = rosso), square(shd = rosso)), 
    hrule = c("diff_shapes"), 
    vrule = "identity"
  )
)

young027b = apply(Raven(
  st1 = cof(dot(shd = giallo, size.x = 7)), 
  hrule = "size"
))


young027 = com(young027a, young027b)

draw(young027, hide = F)
```

```{r out.width="80%"}

dist_young027 = responses(young027)
resp_young027 = select.dist(dist_young027, 
                            select.new)
# resp_young027$wp.copy = cof(resp_young027$wp.copy, 
#                             reflection(triangle(), 2))


dist_young027 = responses(young027,mat.type = 9)
resp_young027 = select.dist(dist_young027, selection.neg)

# ic flip non ha funzionato sul quadrato perché giustamente non funziona più sul quadrato
p = split.mat(young027)

resp_young027[["ic.flip"]] = replace(correct(young027), 
                                     3, 
                                     rotation(p$square, 2)) 


resp_young027[["wp.copy"]] = young027$Sq1

draw.dist(resp_young027, n.resp = 8, main = T)
```


## young028

```{r}
young028a = apply(Raven(
  st1 = square(shd = giallo)
))

young028b = apply(Raven(
  st1 = pacman(), 
  hrule = "fill"
))

young028 = com(young028a, young028b)
draw(young028)
```


```{r out.width="80%"}
selection.neg = c("correct", "r.diag","wp.matrix", "d.union", "ic.scale","ic.flip","ic.inc","ic.neg")

dist_young028 = responses(young028,mat.type = 9)
resp_young028 = select.dist(dist_young028, selection.neg)


resp_young028 = select.dist(dist_young028, 
                            select.new)

# p = split.mat(young028)
# resp_young028$ic.inc = p$square
# 
# resp_young028$ic.scale = cof(p$square, 
#                              size(p$pacman, 2))
# 
# resp_young028$ic.flip = cof(p$square, 
#                              reflection(p$pacman, 2))
# 
# resp_young028$wp.copy = young028$Sq1

draw.dist(resp_young028, n.resp = 8, main = T)



```

## young029 

```{r}
young029a = apply(Raven(
  st1=rectangle(shd = blu, s.x = 20, s.y = 15)
))



young029b= apply(
  Raven(
    st1 = cof(pentagon(shd = "black", s.x = 12, s.y = 12), u.star(), square(shd = "black")), 
    vrule = c("diff_shapes", "size"), 
    hrule = "identity"
  )
)

young029 = com(young029a, young029b)

draw(young029)
```


```{r out.width="80%"}
dist_young029 = responses(young029)

resp_young029 = select.dist(dist_young029, 
                            select.new)
#p= split.mat(young029)

# resp_young029$ic.scale = cof(p$rectangle, 
#                              square(shd = "black"))
resp_young029$d.union = cof(resp_young029$d.union, 
                             size(square(shd = "white"), 2))

resp_young029$wp.matrix = cof(resp_young029$d.union, 
                             size(bow.tie(shd = "white"), 2))


# draw.dist(resp_young029, n.resp = 8)

selection.neg = c("correct", "r.diag", "wp.copy","wp.matrix","d.union", "ic.flip", "ic.scale","ic.neg")

dist_young029 = responses(young029,mat.type = 9)
resp_young029 = select.dist(dist_young029, selection.neg)
draw.dist(resp_young029, n.resp = 8, main = T)

```


## young030 

```{r}
young030a = apply(Raven(
  st1 = cof(square(s.x = 18, s.y = 18), e.hexagon(), 
            pentagon()), 
  hrule = "diff_shapes"
))

young030b = apply(Raven(
  st1 = pacman(shd = rosso, size.x = 8), 
  vrule = "size"
  
))


young030 = com(young030a, young030b)

draw(young030)

```


```{r out.width="80%"}
dist_young030 = responses(young030)

resp_young030 = select.dist(dist_young030, 
                            select.new)
# p= split.mat(young030)
# 
# resp_young030$ic.flip = cof(p$pentagon, 
#                             reflection(p$pacman, 2)) 

draw.dist(resp_young030, n.resp = 8)


```


## young031

```{r}
young031a = apply(Raven(
  st1=rectangle(shd = giallo, s.x = 20, s.y = 15)
))

young031b = apply(Raven(
  st1 = cof(u.smallbow.tie.inv(shd = blu), size(u.star(), 2), u.pie.4( 
                                                    shd = rosso)), 
  vrule  = "diff_shapes"
))

young031 = com(young031a, young031b)

draw(young031)

```


```{r out.width="80%"}

dist_young031 = responses(young031)
resp_young031 = select.dist(dist_young031, 
                            select.new)
p= split.mat(young031)


resp_young031$wp.matrix = cof(resp_young031$wp.matrix, 
                             size(bow.tie(shd = "white"), 2))


resp_young031$ic.inc = cof(p$rectangle, 
                           cof(semi.circle.inv(shd = rosso), 
         semi.circle(shd = rosso)))

# resp_young031$ic.flip = cof(p$rectangle, 
#                             rotation(p$u.pie.4, 2))



#dist_young031 = responses(young031,mat.type = 9)
draw.dist(resp_young031, n.resp = 8, main = T)
# resp_young031[["wp.matrix"]] = cof(resp_young031[["wp.matrix"]],resp_young031[["wp.copy"]])
# resp_young031[["ic.neg"]] = cof(resp_young031[["ic.neg"]],semi.circle(shd=rosso),semi.circle.inv(shd=rosso))
# resp_young031[["ic.flip"]] = rotation(resp_young031[["ic.flip"]],2)



```

## young032

```{r}
young032a = apply(Raven(
  st1=cof(square(shd = giallo), 
          square(shd = blu), 
          square(shd = rosso)), 
  hrule = "diff_shapes"
))

young032b = apply(Raven(
  st1 = cof(u.smallbow.tie.inv(shd = "black"), size(u.star(), 2), 
            size(pacman(shd = "black"), 2)), 
  vrule  = "diff_shapes"
))

young032 = com(young032a, young032b)

draw(young032)
```

```{r out.width="80%"}

dist_young032 = responses(young032)

resp_young032 = select.dist(dist_young032, 
                            select.new)
# p= split.mat(young032)
# 
# resp_young032$ic.scale = cof(p$square, 
#                              size(p$pacman, 2))

resp_young032$wp.matrix = cof(resp_young032$wp.matrix, 
                             (vertical.eight()))



# resp_young032$ic.inc = cof(p$square)
# 
# resp_young032$ic.flip = cof(p$square, 
#                             reflection(p$pacman, 2))

  draw.dist(resp_young032, 
          n.resp = 8)
```

## young033

```{r}
young033 = apply(
  Raven(
    st1 = cof(square(shd = "black"), u.star(), triangle(rot = pi/2, shd = "black")), 
    vrule = c("diff_shapes", "size")
  )
)
draw(young033, n.cell = 9, hide = T)
```

```{r out.width="80%"}

dist_young033 = responses(young033)

select.new1 = c("correct","r.diag", "d.union", "wp.copy", 
                "wp.matrix", "ic.flip", "ic.neg", 
                "ic.scale")

resp_young033 = select.dist(dist_young033, 
                            select.new1)


resp_young033$d.union = cof(resp_young033$d.union, 
                            luck(shd = "white"), 
                            smallbow.tie.inv(shd = "black"))





draw.dist(resp_young033, n.resp = 8)
```


## Young034


```{r}
young034a = apply(Raven(
  st1 = cof(u.star(), pentagon(shd = "black"), e.hexagon(shd = "black")), 
  vrule = "diff_shapes"
))

young034b = apply(
  Raven(
    st1 = dot(shd = "white", size.x = 10), 
    hrule = c("size")
  )
)

young034 = com(young034a, young034b)


draw(young034, n.cell = 9, hide = T)
```

```{r out.width="80%"}

dist_young034 = responses(young034)

resp_young034 = select.dist(dist_young034, 
                            select.new)


resp_young034$d.union = cof(resp_young034$wp.matrix, 
                            
                            smallbow.tie.inv(shd = "black"))

p = split.mat(young034)

#resp_young034$ic.inc = p$e.hexagon
# deve ruotare l'esagono

resp_young034$ic.flip = cof(rotation(p$e.hexagon, 3), 
                            p$dot)

draw.dist(resp_young034, n.resp = 8)

```


## Young035 


```{r}
young035a = apply(Raven(
  st1 = square()
))

young035b = apply(Raven(
  st1 = cof(u.smallbow.tie.inv(), u.pie.2(), pacman()), 
  vrule = c("diff_shapes", "fill")
))

young035 = com(young035a, young035b)


draw(young035)
```


```{r out.width="80%"}
dist_young035 = responses(young035)

resp_young035 = select.dist(dist_young035, 
                            select.new)


resp_young035$wp.matrix = cof(resp_young035$wp.matrix, 
                            
                            smallbow.tie.inv(shd = "black"))

p = split.mat(young035)

# resp_young035$ic.inc = p$square
# 
# resp_young035$ic.flip = cof(reflection(p$pacman, 2), 
#                             p$square)
# 
# 
# resp_young035$ic.scale = cof(size(p$pacman, 2), 
#                             p$square)
draw.dist(resp_young035, n.resp = 8)


```


## Young036

```{r}
young036a = apply(
  Raven(
    st1 = cof(circle(s.x = 17, s.y = 17), 
              pentagon(s.x = 16, s.y = 16), 
              e.hexagon(s.x = 17, s.y = 17)), 
    vrule = c("diff_shapes"), 
    hrule = "diff_shapes"
  )
)

young036b = apply(
  Raven(
    st1 = pacman()
  )
)


young036c = apply(
  Raven(
    st1 = circle(s.x = 2, s.y = 2), 
    vrule = c("fill"), 
    hrule = "fill"
  )
)

young036 = com(young036a, young036b, young036c)
draw(young036, hide = F)
```

```{r out.width="80%"}
dist_young036 = responses(young036)

resp_young036 = select.dist(dist_young036, 
                            select.new)


resp_young036$d.union = cof(resp_young036$r.diag, 
                            
                            lily())

p = split.mat(young036)

resp_young036$ic.flip = cof(reflection(p$pacman, 2), 
                            p$e.hexagon, 
                            p$circle)

resp_young036$wp.copy = young036$Sq1

draw.dist(resp_young036, n.resp = 8)


```

# Adults

\newpage

## adult001

```{r}

adult001 = obj_addition_rules(
  Raven(
    st1 = cof(cross(),square(rot = pi)) 
  ), rule="v.sott"
)

draw(adult001, n.cell = 4)

```


```{r out.width = "80%"}
selection.neg = c("correct", "r.top", "d.union", "wp.matrix", "ic.inc")
dist_adult001 = responses(adult001,mat.type = 4)


resp_adult001 = select.dist(dist_adult001, 
                            selection.neg)


#draw.dist(resp_adult023, n.resp = 5, main = T)

#resp_adult023 = select.dist(dist_adult023, selection.neg)

draw.dist(resp_adult001, n.resp = 5, main = T)

```


## adult002

```{r}
adult002a = obj_addition_rules(
  Raven(
    st1 = cof(circle(s.x=8,s.y = 8),dot()) 
  ), rule="vh.add"
)

adult002b = apply(
  Raven(
    st1 = pentagon() )
)

adult002<-com(adult002a,adult002b)
draw(adult002, n.cell = 4)

```


```{r out.width="80%"}

selection.neg = c("correct", "r.top", "d.union", "wp.matrix", "ic.flip")
dist_adult002 = responses(adult002,mat.type = 4)

resp_adult002 = select.dist(dist_adult002, 
                            selec_add)
resp_adult002[["d.union"]] = cof(resp_adult002$d.union, 
                                 size(biscuit, 1))

#draw.dist(resp_adult002, n.resp = 5, main = T)


resp_adult002 = select.dist(dist_adult002, selection.neg)

draw.dist(resp_adult002, n.resp = 5, main = T)

```


## adult003

```{r}
adult003a = obj_addition_rules(
  Raven(
    st1 = cof(cof(circle(s.x = 7,s.y = 7),dot(),name="oggetto",single=TRUE ),
              dice()) 
  ), rule="vh.add"
)

adult003b = apply(
  Raven(
    st1 =luck() )
)

adult003<-com(adult003a,adult003b)
draw(adult003, n.cell = 4)
```


```{r out.width="80%"}

dist_adult003 = responses(adult003,mat.type = 4)


resp_adult003 = select.dist(dist_adult003, 
                            selec_add)
resp_adult003[["d.union"]] = cof(resp_adult003$d.union, 
                                 bow.tie())

p = split.mat(adult003)

resp_adult003[["ic.scale"]] = cof(size(p[[1]], 2), p[[2]],
                                  size(p[[3]], 2))


# draw.dist(resp_adult003, n.resp = 5, main = T)

resp_adult003 = select.dist(dist_adult003, selection.neg)
resp_adult003[["ic.flip"]] = replace(resp_adult003[["ic.flip"]] ,3 ,luck(rot = pi) )
draw.dist(resp_adult003, n.resp = 5, main = T)

```


## adult004 

```{r}
set.seed(999)
adult004a = apply(
  Raven(
    st1 = cof(square(), u.bow.tie(), triangle(rot = pi/2)), 
    vrule = c("diff_shapes"), 
    hrule = "identity"
  )
)

adult004b = apply(Raven(
  st1 = cof(dot())
))

adult004 = com(adult004a, adult004b)
draw(adult004, n.cell = 9)


```

```{r out.width="80%"}


p = split.mat(adult004)


selection.neg = c("correct", "r.diag", "d.union","wp.copy","wp.matrix", "ic.scale","ic.flip","ic.inc")

dist_adult004 = responses(adult004,mat.type = 9)
resp_adult004 = select.dist(dist_adult004, selection.neg)

# avendo cambiato il codice devo fare a mano ic flip 

resp_adult004[["ic.flip"]] = replace(correct(adult004), 
                                     3, 
                                     rotation(p$triangle, 2))

draw.dist(resp_adult004, n.resp = 8, main = T)

```


## adult005 

```{r}
adult005a= apply(
  Raven(
    st1 = cof(pentagon(), triangle(), square()), 
    hrule = c("diff_shapes"), 
    vrule = "identity"
  )
)

adult005b = apply(Raven(
  st1 = cof(dot(size.x = 7)), 
  hrule = "size"
))


adult005 = com(adult005a, adult005b)

draw(adult005, hide = F)
```

```{r out.width="80%"}

dist_adult005 = responses(adult005,mat.type = 9)
resp_adult005 = select.dist(dist_adult005, selection.neg)

# ic flip non ha funzionato sul quadrato perché giustamente non funziona più sul quadrato
p = split.mat(adult005)

resp_adult005[["ic.flip"]] = replace(correct(adult005), 
                                     3, 
                                     rotation(p$square, 2)) 


resp_adult005[["wp.copy"]] = adult005$Sq1

draw.dist(resp_adult005, n.resp = 8, main = T)
```


## adult006

```{r}
adult006a = apply(Raven(
  st1 = square(shd = "line12")
))

adult006b = apply(Raven(
  st1 = pacman(), 
  hrule = "fill"
))

adult006 = com(adult006a, adult006b)
draw(adult006)
```


```{r out.width="80%"}


dist_adult006 = responses(adult006,mat.type = 9)


resp_adult006 = select.dist(dist_adult006, 
                            select.new)

# p = split.mat(adult006)
# resp_adult006$ic.inc = p$square
# 
# resp_adult006$ic.scale = cof(p$square, 
#                              size(p$pacman, 2))
# 
# resp_adult006$ic.flip = cof(p$square, 
#                              reflection(p$pacman, 2))
# 
# resp_adult006$wp.copy = adult006$Sq1

draw.dist(resp_adult006, n.resp = 8, main = T)



```

## adult007

```{r}
adult007 = apply(
  Raven(
    st1 = cof(square(shd = "black"), u.star(), triangle(rot = pi/2, shd = "black")), 
    vrule = c("diff_shapes", "size")
  )
)
draw(adult007, n.cell = 9, hide = T)
```

```{r out.width="80%"}

dist_adult007 = responses(adult007)

select.new1 = c("correct","r.diag", "d.union", "wp.copy", 
                "wp.matrix", "ic.flip", "ic.neg", 
                "ic.scale")

resp_adult007 = select.dist(dist_adult007, 
                            select.new1)


resp_adult007$d.union = cof(resp_adult007$d.union, 
                            luck(shd = "white"), 
                            smallbow.tie.inv(shd = "black"))





draw.dist(resp_adult007, n.resp = 8)
```


## adult008


```{r}
adult008a = apply(Raven(
  st1 = cof(u.star(), pentagon(shd = "black"), e.hexagon(shd = "black")), 
  vrule = "diff_shapes"
))

adult008b = apply(
  Raven(
    st1 = dot(shd = "white", size.x = 10), 
    hrule = c("size")
  )
)

adult008 = com(adult008a, adult008b)


draw(adult008, n.cell = 9, hide = T)
```

```{r out.width="80%"}

dist_adult008 = responses(adult008)

resp_adult008 = select.dist(dist_adult008, 
                            select.new)


resp_adult008$d.union = cof(resp_adult008$wp.matrix, 
                            
                            smallbow.tie.inv(shd = "black"))

p = split.mat(adult008)

#resp_adult008$ic.inc = p$e.hexagon
# deve ruotare l'esagono

resp_adult008$ic.flip = cof(rotation(p$e.hexagon, 3), 
                            p$dot)

draw.dist(resp_adult008, n.resp = 8)

```


## adult009 


```{r}
adult009a = apply(Raven(
  st1 = square()
))

adult009b = apply(Raven(
  st1 = cof(u.smallbow.tie.inv(), u.pie.2(), pacman()), 
  vrule = c("diff_shapes", "fill")
))

adult009 = com(adult009a, adult009b)


draw(adult009)
```


```{r out.width="80%"}
dist_adult009 = responses(adult009)

resp_adult009 = select.dist(dist_adult009, 
                            select.new)


resp_adult009$wp.matrix = cof(resp_adult009$wp.matrix, 
                              
                              smallbow.tie.inv(shd = "black"))

p = split.mat(adult009)

# resp_adult009$ic.inc = p$square
# 
# resp_adult009$ic.flip = cof(reflection(p$pacman, 2), 
#                             p$square)
# 
# 
# resp_adult009$ic.scale = cof(size(p$pacman, 2), 
#                             p$square)
draw.dist(resp_adult009, n.resp = 8)


```


## adult010

```{r}
adult010a = apply(
  Raven(
    st1 = cof(circle(s.x = 17, s.y = 17), 
              pentagon(s.x = 16, s.y = 16), 
              e.hexagon(s.x = 17, s.y = 17)), 
    vrule = c("diff_shapes"), 
    hrule = "diff_shapes"
  )
)

adult010b = apply(
  Raven(
    st1 = pacman()
  )
)


adult010c = apply(
  Raven(
    st1 = circle(s.x = 2, s.y = 2), 
    vrule = c("fill"), 
    hrule = "fill"
  )
)

adult010 = com(adult010a, adult010b, adult010c)
draw(adult010, hide = F)
```

```{r out.width="80%"}
dist_adult010 = responses(adult010)

resp_adult010 = select.dist(dist_adult010, 
                            select.new)


resp_adult010$d.union = cof(resp_adult010$r.diag, 
                            
                            lily())

p = split.mat(adult010)

resp_adult010$ic.flip = cof(reflection(p$pacman, 2), 
                            p$e.hexagon, 
                            p$circle)

resp_adult010$wp.copy = adult010$Sq1

draw.dist(resp_adult010, n.resp = 8)


```


## adult011


```{r}
adult011a = apply(Raven(
  st1 = cof(square(shd = "grey", 
                   s.x = 20, 
                   s.y = 20)), 
  "identity"
))

adult011b = apply(Raven(
  st1 = cof(luck(shd = "black", s.x = 10, s.y =8), u.biscuit, 
                 triangle(shd = "black", s.x = 10, s.y = 10)), 
  hrule = "diff_shapes", 
  vrule = c("diff_shapes", "size")
))

adult011 = com(adult011a, adult011b)

draw(adult011)

```

```{r out.width="80%"}
dist_adult011 = responses(adult011)

draw.dist(dist_adult011, n.resp = 11, main = T)

```

## adult012
```{r}
adult012a =  apply(Raven(
  st1 = cof(rectangle(s.x = 20, s.y = 15), 
            pentagon(s.x = 17, s.y = 17), 
            e.hexagon()), 
  hrule = "diff_shapes.inv", 
  vrule = "diff_shapes.inv"
))


adult012bb = apply(Raven(
  st1 = circle(shd = "black"), 
  vrule = "size", 
  hrule = "size"
))

adult012 = com(adult012a, adult012bb)

draw(adult012)

```

```{r out.width="80%"}
dist_adult012 = responses(adult012)

draw.dist(dist_adult012, n.resp = 11, main = T)

```

## adult017 



```{r}
adult017a = apply(
  Raven(
    st1 = square(), 
    vrule = c("lty"), 
    hrule = c("identity")
  )
)



adult017b = apply(
  Raven(
    st1 = cof(circle(s.x = 3, s.y = 3, shd = "grey"), 
              pentagon(s.x = 5, s.y = 5, shd = "grey"), 
              luck(s.x = 5, s.y = 3, shd = "grey")), 
    vrule = c( "diff_shapes.inv"), 
    hrule = c( "diff_shapes.inv")
  )
)


# adult017c = apply(
#   Raven(
#     st1 = square(s.x = 13, s.y = 13), 
#     vrule = c("lty"), 
#     hrule = c("identity")
#   )
# )



adult017 = com(adult017a, adult017b) 
draw(adult017)

```

```{r out.width="80%"}
dist_adult017 = responses(adult017)

draw.dist(dist_adult017, n.resp = 11, main = T)

```

## adult018

```{r}
adult018a = apply(Raven(
  st1 = cof(pentagon(), e.hexagon(), 
            rectangle(s.y = 10, s.x = 15)), 
  hrule = "diff_shapes.inv", 
  vrule = "diff_shapes.inv"
))


adult018b = apply(Raven(
  st1 = u.smallbow.tie.inv(), 
  hrule = c("lty"), 
  vrule = c("lty")
))

adult018c = apply(Raven(
  st1 = dot(shd = "black"),
  hrule = c("identity"),
  vrule = c("identity")
))

adult018 = com(adult018a, adult018b, adult018c)

draw(adult018)

```

```{r out.width="80%"}
dist_adult018 = responses(adult018)

draw.dist(dist_adult018, n.resp = 11, main = T)

```

## Adult019 

TL-LR-increasing

```{r}
adult019a = apply(Raven(pacman()))
adult019  = numeric_progression(adult019a,"TL-LR-increasing")
draw(adult019)
```


```{r out.width="90%"}
dist_adult019 = responses(adult019)

draw.dist(dist_adult019, n.resp = 11)

```


## Adult020

LL-TR

```{r}
adult020a = apply(Raven(hexagon()))
adult020  = numeric_progression(adult020a,"LL-TR")
draw(adult020)
```


```{r out.width="90%"}
dist_adult020 = responses(adult020)

draw.dist(dist_adult020, n.resp = 11)

```

## Adult021 

Forma e progressione quantitiva V su entrambe

```{r}

adult021a = apply(Raven(
  st1 = cof(u.star(), triangle(shd = "black"), pacman(shd = "black")), 
  vrule = "diff_shapes"
))
adult021 = numeric_progression(adult021a, "v.increasing")

draw(adult021)
```


```{r out.width="80%"}
dist_adult021 = responses(adult021)

draw.dist(dist_adult021, n.resp = 11)
```


## Adult022 

Forma (H) e progressione quantitiva (V)

```{r}

adult022a = apply(Raven(
  st1 = cof(triangle(), square(), pentagon()), 
  hrule = "diff_shapes"
))
adult022 = numeric_progression(adult022a, "v.increasing")

draw(adult022)
```


```{r out.width="80%"}
dist_adult022 = responses(adult022)

draw.dist(dist_adult022, n.resp = 11)
```


## Adult023

Orientamento (V) e progressione quantitiva (V)

```{r}

adult023a = apply(Raven(
  st1 = pacman(), 
  vrule = "rotation"
))
adult023 = numeric_progression(adult023a, "v.increasing")

draw(adult023)
```


```{r out.width="80%"}
dist_adult023 = responses(adult023)

draw.dist(dist_adult023, n.resp = 11)
```

## Adulta024 
```{r}

adult024a = apply(Raven(
  st1 = slice(), 
  hrule = "rotation"
))
adult024 = numeric_progression(adult024a, "h.increasing")

draw(adult024)
```


```{r out.width="80%"}
dist_adult024 = responses(adult024)

draw.dist(dist_adult024, n.resp = 11)
```




## adult025

```{r}
adult025a = apply(Raven(
  st1 = cof(pentagon(), 
            e.hexagon(), 
            ellipse(s.x = 13, s.y = 17)), 
  vrule = c("diff_shapes"),
  hrule= "lty"
))



adult025b = apply(Raven(
  st1 = papillon,
  hrule = "identity",
  vrule = "multifill"
))

adult025 = com(adult025a, adult025b)

draw(adult025, hide = F)

```

Qui bisogna farle a mano perché usiamo papillon che non è realmente una forma dentro il pacchetto

```{r out.width="80%"}
dist_adult025 = responses(adult025)

draw.dist(dist_adult025, n.resp = 11, main = T)
```


## adult026



```{r}
adult026a = apply(
  Raven(
    st1 = square(), 
    vrule = c("identity"), 
    hrule = c("identity")
  )
)



adult026c = apply(
  Raven(
    st1 = cof(circle(s.x = 3, s.y = 3), 
              pentagon(s.x = 5, s.y = 5), 
              luck(s.x = 5, s.y = 3)), 
    vrule = c("fill", "diff_shapes.inv"), 
    hrule = c("fill", "diff_shapes.inv")
  )
)


adult026b = apply(
  Raven(
    st1 = square(s.x = 13, s.y = 13), 
    vrule = c("lty"), 
    hrule = c("identity")
  )
)



adult026 = com(adult026a, adult026b, adult026c) 
draw(adult026)

```

```{r out.width="80%"}
dist_adult026 = responses(adult026)

draw.dist(dist_adult026, n.resp = 11, main = T)

```

## adult027

```{r}
adult027a = apply(Raven(
  st1 = cof(pentagon(), e.hexagon(), 
            rectangle(s.y = 10, s.x = 15)), 
  hrule = "diff_shapes.inv", 
  vrule = "diff_shapes.inv"
))


adult027b = apply(Raven(
  st1 = smallbow.tie.inv(), 
  hrule = c("lty"), 
  vrule = c("lty")
))

adult027c = apply(Raven(
  st1 = dot(), 
  hrule = c("fill"), 
  vrule = c("fill")
))

adult027 = com(adult027a, adult027b, adult027c)

draw(adult027)

```

```{r out.width="80%"}
dist_adult027 = responses(adult027)

draw.dist(dist_adult027, n.resp = 11, main = T)

```

## adult028 


```{r}
adult028a = apply(Raven(
  st1 = cof(square(shd = "line12", s.x = 17, s.y = 17), 
            e.hexagon(shd = "line12"), 
            luck(shd = "line12")), 
  vrule = "diff_shapes"
)) 

adult028b = apply(Raven(
  st1 = pacman(size.x = 10), 
vrule = "size", hrule = "fill"
  ))

adult028 = com(adult028a, adult028b)


draw(adult028)

```

```{r out.width="80%"}
dist_adult028 = responses(adult028)

draw.dist(dist_adult028, main = T)

```

## adult028

```{r}
adult029a = apply(Raven(
  st1 = cof(e.hexagon(), 
            square(), 
            pentagon()), 
  hrule = c("diff_shapes.inv"), 
  vrule = c("diff_shapes.inv", "filline")
))
adult029b = apply(
  Raven(
    st1 = circle(shd = "black", s.x = 5, s.y = 5), 
    vrule = "size"
  )
)

adult029 = com(adult029a, adult029b)

draw(adult029)

```


```{r out.width="80%"}
dist_adult029 = responses(adult029)

draw.dist(dist_adult029, main = T)

```



## adult030

```{r}
adult030a = apply(Raven(
  st1 = rectangle(s.x = 18, s.y = 18)
))

adult030b = apply(
  Raven(
    st1 = cof(circle(shd = "white"), 
              luck(shd = "white"), 
              pacman(shd = "white")), 
    vrule = c("size", "diff_shapes.inv", "fill"),
    hrule = c("diff_shapes.inv", "fill")
  )
)

adult030 = com(adult030a, adult030b)

draw(adult030)
```

```{r out.width="80%"}

dist_adult030 = responses(adult030)

draw.dist(dist_adult030)

```


